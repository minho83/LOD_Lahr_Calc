<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>라르 계산기 - 어둠의전설</title>

    <!-- Open Graph / 카카오톡, 페이스북 미리보기 -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="라르 포인트 계산기">
    <meta property="og:description" content="어둠의전설 순수 HP/MP 강화에 필요한 라르를 계산해보세요">
    <meta property="og:image" content="https://minho83.github.io/LOD_Lahr_Calc/Thumbnail.png">
    <meta property="og:url" content="https://minho83.github.io/LOD_Lahr_Calc/">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="라르 포인트 계산기">
    <meta name="twitter:description" content="어둠의전설 순수 HP/MP 강화에 필요한 라르를 계산해보세요">
    <meta name="twitter:image" content="https://minho83.github.io/LOD_Lahr_Calc/Thumbnail.png">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap');
        
        body {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 25%, #334155 50%, #1e293b 100%);
            background-attachment: fixed;
            min-height: 100vh;
            font-family: 'Noto Sans KR', sans-serif;
            color: #e2e8f0;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(59, 130, 246, 0.08) 0%, transparent 60%),
                radial-gradient(circle at 80% 80%, rgba(96, 165, 250, 0.06) 0%, transparent 60%);
            pointer-events: none;
            z-index: 0;
        }

        body > * {
            position: relative;
            z-index: 1;
        }

        .glass-card {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(15px);
            border-radius: 16px;
            box-shadow: 
                0 8px 32px 0 rgba(0, 0, 0, 0.5),
                inset 0 1px 0 rgba(148, 163, 184, 0.1);
            border: 1px solid rgba(100, 116, 139, 0.2);
        }

        .hp-theme {
            background: linear-gradient(135deg, #8b4513 0%, #cd5c5c 100%);
            box-shadow: 0 4px 15px rgba(205, 92, 92, 0.3);
        }

        .mp-theme {
            background: linear-gradient(135deg, #2d5016 0%, #4a7c2a 100%);
            box-shadow: 0 4px 15px rgba(74, 124, 42, 0.3);
        }

        .input-field {
            background: rgba(51, 65, 85, 0.6);
            color: #e2e8f0;
            border: 1px solid rgba(100, 116, 139, 0.3);
            transition: all 0.3s ease;
        }

        .input-field::placeholder {
            color: rgba(226, 232, 240, 0.5);
        }

        .input-field:focus {
            background: rgba(51, 65, 85, 0.8);
            border-color: rgba(59, 130, 246, 0.6);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1), 0 4px 12px rgba(0, 0, 0, 0.3);
            transform: translateY(-2px);
            color: #ffffff;
        }

        .calc-button {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 50%, #1d4ed8 100%);
            border: 1px solid rgba(59, 130, 246, 0.3);
            box-shadow: 
                0 4px 15px rgba(59, 130, 246, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .calc-button:hover {
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 50%, #1e40af 100%);
            transform: translateY(-2px);
            box-shadow: 
                0 8px 25px rgba(59, 130, 246, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
        }

        .calc-button:active {
            transform: translateY(0);
        }

        .result-card {
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .tier-row {
            transition: all 0.3s ease;
        }

        .tier-row:hover {
            background-color: rgba(138, 43, 226, 0.1);
            transform: translateX(5px);
        }

        table {
            border-collapse: collapse;
            background: rgba(30, 41, 59, 0.7);
        }

        th {
            font-weight: bold;
            text-align: center;
            padding: 10px;
            border: 1px solid rgba(100, 116, 139, 0.3);
        }

        td {
            padding: 8px;
            border: 1px solid rgba(100, 116, 139, 0.2);
            color: #e2e8f0;
        }

        .table-hp th {
            background: linear-gradient(135deg, #991b1b 0%, #dc2626 100%);
            color: white;
            border-color: rgba(220, 38, 38, 0.5);
        }

        .table-mp th {
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            color: white;
            border-color: rgba(59, 130, 246, 0.5);
        }

        .table-total {
            background: rgba(59, 130, 246, 0.15);
            font-weight: bold;
            color: #ffffff;
        }

        .table-black {
            background-color: rgba(15, 23, 42, 0.6);
        }

        .collapsible {
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 8px;
        }

        .collapsible:hover {
            background-color: rgba(59, 130, 246, 0.1);
        }

        h1, h2, h3 {
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.8), 0 0 20px rgba(59, 130, 246, 0.2);
        }

        label {
            color: #cbd5e1;
        }

        select {
            background-color: rgba(51, 65, 85, 0.6);
            color: #e2e8f0;
        }

        select option {
            background-color: #1e293b;
            color: #e2e8f0;
        }
    </style>
</head>

<body class="p-4 md:p-8">
    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-5xl md:text-6xl font-bold text-white mb-4 drop-shadow-lg">
                <i class="fas fa-calculator mr-3"></i>라르 포인트 계산기
            </h1>
            <p class="text-xl text-white opacity-90">어둠의전설 순수 HP/MP 강화에 필요한 라르를 계산해보세요</p>
        </div>

        <!-- Quick Links -->
        <div class="glass-card p-6 mb-8">
            <div class="flex items-center justify-between flex-col md:flex-row gap-4">
                <div class="text-left">
                    <div class="text-sm text-slate-300 font-medium">다른 계산기</div>
                    <div class="text-lg font-bold text-white">정령 / 혼 계산기도 바로 열기</div>
                    <div class="text-xs text-slate-400 mt-1">새 탭으로 열립니다</div>
                </div>

                <div class="flex flex-col sm:flex-row gap-3 w-full md:w-auto">
                    <a href="https://minho83.github.io/lod_Spirit/"
                        target="_blank" rel="noopener noreferrer"
                        class="calc-button px-5 py-3 rounded-lg font-bold text-white flex items-center justify-center gap-2 w-full md:w-auto">
                        <i class="fas fa-wand-magic-sparkles"></i>
                        정령 레벨업 비용 계산기
                    </a>
                    <a href="https://minho83.github.io/horn_calculator/"
                        target="_blank" rel="noopener noreferrer"
                        class="calc-button px-5 py-3 rounded-lg font-bold text-white flex items-center justify-center gap-2 w-full md:w-auto">
                        <i class="fas fa-hat-wizard"></i>
                        혼 계산기
                    </a>
                </div>
            </div>
        </div>

        <!-- Input Section -->
        <div class="glass-card p-8 mb-8">
            <div class="grid md:grid-cols-2 gap-8 mb-6">
                <!-- HP Calculator -->
                <div class="space-y-4">
                    <div class="flex items-center mb-4">
                        <div class="hp-theme w-12 h-12 rounded-full flex items-center justify-center mr-3">
                            <i class="fas fa-heart text-white text-xl"></i>
                        </div>
                        <h2 class="text-2xl font-bold text-white">HP 계산</h2>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">현재 HP</label>
                        <input type="text" id="currentHP" placeholder="예: 3,000,000"
                            class="input-field w-full px-4 py-3 border-2 border-red-400 rounded-lg focus:outline-none focus:border-red-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">목표 HP</label>
                        <input type="text" id="targetHP" placeholder="예: 5,800,000"
                            class="input-field w-full px-4 py-3 border-2 border-red-400 rounded-lg focus:outline-none focus:border-red-500">
                    </div>
                </div>

                <!-- MP Calculator -->
                <div class="space-y-4">
                    <div class="flex items-center mb-4">
                        <div class="mp-theme w-12 h-12 rounded-full flex items-center justify-center mr-3">
                            <i class="fas fa-bolt text-white text-xl"></i>
                        </div>
                        <h2 class="text-2xl font-bold text-white">MP 계산</h2>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">현재 MP</label>
                        <input type="text" id="currentMP" placeholder="예: 150,000"
                            class="input-field w-full px-4 py-3 border-2 border-blue-400 rounded-lg focus:outline-none focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">목표 MP</label>
                        <input type="text" id="targetMP" placeholder="예: 2,800,000"
                            class="input-field w-full px-4 py-3 border-2 border-blue-400 rounded-lg focus:outline-none focus:border-blue-500">
                    </div>
                </div>
            </div>

            <div class="mt-6 pt-6 border-t-2 border-slate-600 border-opacity-40">
                <div class="grid md:grid-cols-2 gap-6 max-w-2xl mx-auto">
                    <!-- 라르 할인율 -->
                    <div class="bg-slate-700 bg-opacity-30 rounded-xl p-4">
                        <label class="block text-sm font-medium text-gray-300 mb-3">
                            <i class="fas fa-percent mr-2 text-purple-400"></i>라르 할인율
                        </label>
                        <div class="flex items-center gap-2">
                            <button type="button" onclick="adjustDiscountRate(-10)"
                                class="w-10 h-10 rounded-lg bg-purple-600 bg-opacity-50 hover:bg-opacity-70 text-white font-bold text-lg transition-all active:scale-95 flex items-center justify-center">
                                −
                            </button>
                            <div class="relative flex-1">
                                <input type="number" id="discountRate" placeholder="0" value="0" min="0" max="99"
                                    class="input-field w-full px-3 py-2 border-2 border-purple-400 border-opacity-50 rounded-lg focus:outline-none focus:border-purple-500 text-center text-lg font-semibold">
                                <span class="absolute right-3 top-1/2 transform -translate-y-1/2 text-purple-300 font-medium">%</span>
                            </div>
                            <button type="button" onclick="adjustDiscountRate(10)"
                                class="w-10 h-10 rounded-lg bg-purple-600 bg-opacity-50 hover:bg-opacity-70 text-white font-bold text-lg transition-all active:scale-95 flex items-center justify-center">
                                +
                            </button>
                        </div>
                        <p class="text-xs text-gray-400 mt-2 text-center">10% 단위 조절 (0~99%)</p>
                    </div>
                    <!-- 어둠돈 환율 -->
                    <div class="bg-slate-700 bg-opacity-30 rounded-xl p-4">
                        <label class="block text-sm font-medium text-gray-300 mb-3">
                            <i class="fas fa-coins mr-2 text-blue-400"></i>어둠돈 1억 = 현금
                        </label>
                        <div class="flex items-center gap-2">
                            <button type="button" onclick="adjustExchangeRate(-100)"
                                class="w-10 h-10 rounded-lg bg-blue-600 bg-opacity-50 hover:bg-opacity-70 text-white font-bold text-lg transition-all active:scale-95 flex items-center justify-center">
                                −
                            </button>
                            <div class="relative flex-1">
                                <input type="text" id="exchangeRate" placeholder="6,000" value="6,000"
                                    class="input-field w-full px-3 py-2 border-2 border-blue-400 border-opacity-50 rounded-lg focus:outline-none focus:border-blue-500 text-center text-lg font-semibold">
                                <span class="absolute right-3 top-1/2 transform -translate-y-1/2 text-blue-300 font-medium">원</span>
                            </div>
                            <button type="button" onclick="adjustExchangeRate(100)"
                                class="w-10 h-10 rounded-lg bg-blue-600 bg-opacity-50 hover:bg-opacity-70 text-white font-bold text-lg transition-all active:scale-95 flex items-center justify-center">
                                +
                            </button>
                        </div>
                        <p class="text-xs text-gray-400 mt-2 text-center">100원 단위 조절</p>
                    </div>
                </div>
            </div>

            <!-- 무료 라르 입력 섹션 -->
            <div class="mt-6 pt-6 border-t-2 border-slate-600 border-opacity-40">
                <div class="flex items-center justify-center mb-4">
                    <div class="w-10 h-10 rounded-full flex items-center justify-center mr-3" style="background: linear-gradient(135deg, #059669 0%, #10b981 100%);">
                        <i class="fas fa-gift text-white text-lg"></i>
                    </div>
                    <h2 class="text-xl font-bold text-white">무료 라르 (목표 기간 계산)</h2>
                </div>
                <div class="grid md:grid-cols-3 gap-6 max-w-3xl mx-auto">
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">매일 무료 라르</label>
                        <input type="text" id="dailyFreeRar" placeholder="예: 100" value="0"
                            class="input-field w-full px-4 py-3 border-2 border-emerald-400 rounded-lg focus:outline-none focus:border-emerald-500">
                        <p class="text-xs text-gray-400 mt-1">매일 획득 가능한 무료 라르 개수</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">주간 무료 라르</label>
                        <input type="text" id="weeklyFreeRar" placeholder="예: 500" value="0"
                            class="input-field w-full px-4 py-3 border-2 border-emerald-400 rounded-lg focus:outline-none focus:border-emerald-500">
                        <p class="text-xs text-gray-400 mt-1">주간 보상으로 획득 가능한 무료 라르 개수</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">목표 기간 (일)</label>
                        <input type="text" id="targetDays" placeholder="예: 30" value=""
                            class="input-field w-full px-4 py-3 border-2 border-amber-400 rounded-lg focus:outline-none focus:border-amber-500">
                        <p class="text-xs text-gray-400 mt-1">목표 달성까지 원하는 기간</p>
                    </div>
                </div>
            </div>

            <div class="text-center mt-6">
                <button onclick="calculate()"
                    class="calc-button px-12 py-4 text-white text-xl font-bold rounded-full shadow-lg">
                    <i class="fas fa-magic mr-2"></i>계산하기
                </button>
            </div>

            <div id="errorMessage" class="mt-4 text-center text-red-400 font-semibold hidden"></div>
        </div>

        <!-- Results Section -->
        <div id="resultsSection" class="hidden">
            <!-- Total Summary -->
            <div class="glass-card p-8 mb-8 text-center result-card">
                <h3 class="text-3xl font-bold text-white mb-6">
                    <i class="fas fa-chart-line mr-2"></i>계산 결과
                </h3>
                <div class="grid md:grid-cols-3 gap-6">
                    <div>
                        <div class="text-5xl font-bold text-blue-400 mb-3" id="totalRar"></div>
                        <div class="text-xl text-gray-300">총 필요 라르</div>
                    </div>
                    <div>
                        <div class="text-5xl font-bold text-blue-300 mb-3" id="totalCost"></div>
                        <div class="text-xl text-gray-300">총 비용 (골드)</div>
                    </div>
                    <div>
                        <div class="text-5xl font-bold text-sky-300 mb-3" id="totalCash"></div>
                        <div class="text-xl text-gray-300">예상 현금 비용</div>
                    </div>
                </div>
            </div>

            <!-- 무료 라르로 목표 달성 기간 -->
            <div id="freeRarSection" class="glass-card p-8 mb-8 text-center result-card hidden">
                <h3 class="text-2xl font-bold text-white mb-6">
                    <i class="fas fa-calendar-alt mr-2" style="color: #10b981;"></i>무료 라르로 목표 달성 예상 기간
                </h3>
                <div class="grid md:grid-cols-3 gap-6 mb-6">
                    <div>
                        <div class="text-4xl font-bold text-emerald-400 mb-2" id="weeklyRarTotal"></div>
                        <div class="text-lg text-gray-300">주간 획득 라르</div>
                        <div class="text-sm text-gray-400" id="weeklyRarBreakdown"></div>
                    </div>
                    <div>
                        <div class="text-5xl font-bold text-emerald-300 mb-2" id="weeksNeeded"></div>
                        <div class="text-xl text-gray-300">예상 소요 기간</div>
                    </div>
                    <div>
                        <div class="text-4xl font-bold text-teal-300 mb-2" id="targetDate"></div>
                        <div class="text-lg text-gray-300">예상 달성일</div>
                    </div>
                </div>
                <div class="bg-slate-700 bg-opacity-50 rounded-lg p-4 max-w-xl mx-auto">
                    <p class="text-gray-300 text-sm">
                        <i class="fas fa-info-circle mr-2 text-emerald-400"></i>
                        무료 라르만으로 목표 달성 시 예상 기간입니다.
                    </p>
                </div>
            </div>

            <!-- 목표 기간 내 필요 라르 계산 -->
            <div id="targetDaysSection" class="glass-card p-8 mb-8 text-center result-card hidden">
                <h3 class="text-2xl font-bold text-white mb-6">
                    <i class="fas fa-crosshairs mr-2" style="color: #f59e0b;"></i>목표 기간 내 달성 분석
                </h3>
                <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                    <div>
                        <div class="text-3xl font-bold text-amber-400 mb-2" id="targetDaysDisplay"></div>
                        <div class="text-lg text-gray-300">목표 기간</div>
                    </div>
                    <div>
                        <div class="text-3xl font-bold text-emerald-400 mb-2" id="freeRarInPeriod"></div>
                        <div class="text-lg text-gray-300">기간 내 무료 라르</div>
                        <div class="text-sm text-gray-400" id="freeRarInPeriodBreakdown"></div>
                    </div>
                    <div>
                        <div class="text-3xl font-bold mb-2" id="shortfallRar"></div>
                        <div class="text-lg text-gray-300">부족한 라르</div>
                    </div>
                    <div>
                        <div class="text-3xl font-bold text-blue-300 mb-2" id="shortfallCost"></div>
                        <div class="text-lg text-gray-300">추가 필요 비용</div>
                    </div>
                </div>
                <div id="targetDaysMessage" class="bg-slate-700 bg-opacity-50 rounded-lg p-4 max-w-2xl mx-auto">
                </div>
            </div>
        </div>

        <!-- Data Tables Section -->
        <div class="glass-card p-6 mb-8">
            <div class="collapsible flex items-center justify-between p-4 rounded-lg" onclick="toggleTable('hpTable')">
                <h3 class="text-xl font-bold text-white">
                    <i class="fas fa-table mr-2"></i>순수 HP 데이터 테이블
                </h3>
                <i class="fas fa-chevron-down transition-transform" id="hpTableIcon"></i>
            </div>
            <div id="hpTable" class="mt-4 overflow-x-auto hidden">
                <table class="w-full text-sm">
                    <thead class="table-hp">
                        <tr>
                            <th>순수 HP</th>
                            <th>1회상승</th>
                            <th>필요 라르</th>
                            <th>경렬횟수</th>
                            <th>필요 라르갯수</th>
                            <th>라르 금액환산</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>30만 이상 ~ 40만 미만</td>
                            <td></td>
                            <td style="text-align:right">10</td>
                            <td style="text-align:right">2,000</td>
                            <td style="text-align:right">20,000</td>
                            <td style="text-align:right">200,000,000</td>
                            <td>2억</td>
                        </tr>
                        <tr>
                            <td>40만 이상 ~ 50만 미만</td>
                            <td></td>
                            <td style="text-align:right">20</td>
                            <td style="text-align:right">2,000</td>
                            <td style="text-align:right">40,000</td>
                            <td style="text-align:right">400,000,000</td>
                            <td>4억</td>
                        </tr>
                        <tr>
                            <td>50만 이상 ~ 100만 미만</td>
                            <td style="text-align:right">50</td>
                            <td style="text-align:right">30</td>
                            <td style="text-align:right">10,000</td>
                            <td style="text-align:right">300,000</td>
                            <td style="text-align:right">3,000,000,000</td>
                            <td>30억</td>
                        </tr>
                        <tr>
                            <td>100만 이상 ~ 250만 미만</td>
                            <td></td>
                            <td style="text-align:right">50</td>
                            <td style="text-align:right">30,000</td>
                            <td style="text-align:right">1,500,000</td>
                            <td style="text-align:right">15,000,000,000</td>
                            <td>150억</td>
                        </tr>
                        <tr>
                            <td>250만 이상 ~ 555만 미만</td>
                            <td></td>
                            <td style="text-align:right">100</td>
                            <td style="text-align:right">61,000</td>
                            <td style="text-align:right">6,100,000</td>
                            <td style="text-align:right">61,000,000,000</td>
                            <td>610억</td>
                        </tr>
                        <tr>
                            <td>555만 이상 ~ 560만 미만</td>
                            <td style="text-align:right">45</td>
                            <td style="text-align:right">200</td>
                            <td style="text-align:right">1,112</td>
                            <td style="text-align:right">222,400</td>
                            <td style="text-align:right">2,224,000,000</td>
                            <td>22.24억</td>
                        </tr>
                        <tr>
                            <td>560만 이상 ~ 565만 미만</td>
                            <td style="text-align:right">40</td>
                            <td style="text-align:right">200</td>
                            <td style="text-align:right">1,250</td>
                            <td style="text-align:right">250,000</td>
                            <td style="text-align:right">2,500,000,000</td>
                            <td>25억</td>
                        </tr>
                        <tr>
                            <td>565만 이상 ~ 570만 미만</td>
                            <td style="text-align:right">35</td>
                            <td style="text-align:right">200</td>
                            <td style="text-align:right">1,428</td>
                            <td style="text-align:right">285,600</td>
                            <td style="text-align:right">2,856,000,000</td>
                            <td>28.56억</td>
                        </tr>
                        <tr>
                            <td>570만 이상 ~ 575만 미만</td>
                            <td style="text-align:right">30</td>
                            <td style="text-align:right">200</td>
                            <td style="text-align:right">1,666</td>
                            <td style="text-align:right">333,200</td>
                            <td style="text-align:right">3,332,000,000</td>
                            <td>33.32억</td>
                        </tr>
                        <tr>
                            <td>575만 이상 ~ 580만 미만</td>
                            <td style="text-align:right">25</td>
                            <td style="text-align:right">200</td>
                            <td style="text-align:right">2,000</td>
                            <td style="text-align:right">400,000</td>
                            <td style="text-align:right">4,000,000,000</td>
                            <td>40억</td>
                        </tr>
                        <tr>
                            <td>580만 이상 ~ 585만 미만</td>
                            <td style="text-align:right">20</td>
                            <td style="text-align:right">200</td>
                            <td style="text-align:right">2,500</td>
                            <td style="text-align:right">500,000</td>
                            <td style="text-align:right">5,000,000,000</td>
                            <td>50억</td>
                        </tr>
                        <tr>
                            <td>585만 이상 ~ 590만 미만</td>
                            <td style="text-align:right">15</td>
                            <td style="text-align:right">200</td>
                            <td style="text-align:right">3,334</td>
                            <td style="text-align:right">666,800</td>
                            <td style="text-align:right">6,668,000,000</td>
                            <td>66.68억</td>
                        </tr>
                        <tr>
                            <td>590만 이상 ~ 595만 미만</td>
                            <td style="text-align:right">10</td>
                            <td style="text-align:right">200</td>
                            <td style="text-align:right">5,000</td>
                            <td style="text-align:right">1,000,000</td>
                            <td style="text-align:right">10,000,000,000</td>
                            <td>100억</td>
                        </tr>
                        <tr>
                            <td>595만 이상 ~ 600만 미만</td>
                            <td style="text-align:right">5</td>
                            <td style="text-align:right">200</td>
                            <td style="text-align:right">10,000</td>
                            <td style="text-align:right">2,000,000</td>
                            <td style="text-align:right">20,000,000,000</td>
                            <td>200억</td>
                        </tr>
                        <tr>
                            <td>600만 이상</td>
                            <td style="text-align:right">1</td>
                            <td style="text-align:right">200</td>
                            <td class="table-black"></td>
                            <td class="table-black"></td>
                            <td class="table-black"></td>
                            <td></td>
                        </tr>
                        <tr class="table-total">
                            <td>합계</td>
                            <td></td>
                            <td></td>
                            <td style="text-align:right">13,618,000</td>
                            <td style="text-align:right">136,180,000,000</td>
                            <td></td>
                            <td>1361.8억</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="collapsible flex items-center justify-between p-4 rounded-lg mt-4"
                onclick="toggleTable('mpTable')">
                <h3 class="text-xl font-bold text-white">
                    <i class="fas fa-table mr-2"></i>순수 MP 데이터 테이블
                </h3>
                <i class="fas fa-chevron-down transition-transform" id="mpTableIcon"></i>
            </div>
            <div id="mpTable" class="mt-4 overflow-x-auto hidden">
                <table class="w-full text-sm">
                    <thead class="table-mp">
                        <tr>
                            <th>순수 MP</th>
                            <th>1회상승</th>
                            <th>필요 라르</th>
                            <th>경렬횟수</th>
                            <th>필요 라르갯수</th>
                            <th>라르 금액환산</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>15만 이상 ~ 20만 미만</td>
                            <td></td>
                            <td style="text-align:right">10</td>
                            <td style="text-align:right">2,000</td>
                            <td style="text-align:right">20,000</td>
                            <td style="text-align:right">200,000,000</td>
                            <td>2억</td>
                        </tr>
                        <tr>
                            <td>20만 이상 ~ 25만 미만</td>
                            <td></td>
                            <td style="text-align:right">20</td>
                            <td style="text-align:right">2,000</td>
                            <td style="text-align:right">40,000</td>
                            <td style="text-align:right">400,000,000</td>
                            <td>4억</td>
                        </tr>
                        <tr>
                            <td>25만 이상 ~ 50만 미만</td>
                            <td></td>
                            <td style="text-align:right">30</td>
                            <td style="text-align:right">10,000</td>
                            <td style="text-align:right">300,000</td>
                            <td style="text-align:right">3,000,000,000</td>
                            <td>30억</td>
                        </tr>
                        <tr>
                            <td>50만 이상 ~ 100만 미만</td>
                            <td style="text-align:right">25</td>
                            <td style="text-align:right">50</td>
                            <td style="text-align:right">20,000</td>
                            <td style="text-align:right">1,000,000</td>
                            <td style="text-align:right">10,000,000,000</td>
                            <td>100억</td>
                        </tr>
                        <tr>
                            <td>100만 이상 ~ 125만 미만</td>
                            <td></td>
                            <td style="text-align:right">50</td>
                            <td style="text-align:right">10,000</td>
                            <td style="text-align:right">500,000</td>
                            <td style="text-align:right">5,000,000,000</td>
                            <td>50억</td>
                        </tr>
                        <tr>
                            <td>125만 이상 ~ 275만 미만</td>
                            <td></td>
                            <td style="text-align:right">100</td>
                            <td style="text-align:right">60,000</td>
                            <td style="text-align:right">6,000,000</td>
                            <td style="text-align:right">60,000,000,000</td>
                            <td>600억</td>
                        </tr>
                        <tr>
                            <td>275만 이상 ~ 280만 미만</td>
                            <td></td>
                            <td style="text-align:right">200</td>
                            <td style="text-align:right">2,000</td>
                            <td style="text-align:right">400,000</td>
                            <td style="text-align:right">4,000,000,000</td>
                            <td>40억</td>
                        </tr>
                        <tr>
                            <td>280만 이상 ~ 285만 미만</td>
                            <td style="text-align:right">20</td>
                            <td style="text-align:right">200</td>
                            <td style="text-align:right">2,500</td>
                            <td style="text-align:right">500,000</td>
                            <td style="text-align:right">5,000,000,000</td>
                            <td>50억</td>
                        </tr>
                        <tr>
                            <td>285만 이상 ~ 290만 미만</td>
                            <td style="text-align:right">15</td>
                            <td style="text-align:right">200</td>
                            <td style="text-align:right">3,334</td>
                            <td style="text-align:right">666,800</td>
                            <td style="text-align:right">6,668,000,000</td>
                            <td>66.68억</td>
                        </tr>
                        <tr>
                            <td>290만 이상 ~ 295만 미만</td>
                            <td style="text-align:right">10</td>
                            <td style="text-align:right">200</td>
                            <td style="text-align:right">5,000</td>
                            <td style="text-align:right">1,000,000</td>
                            <td style="text-align:right">10,000,000,000</td>
                            <td>100억</td>
                        </tr>
                        <tr>
                            <td>295만 이상 ~ 300만 미만</td>
                            <td style="text-align:right">5</td>
                            <td style="text-align:right">200</td>
                            <td style="text-align:right">10,000</td>
                            <td style="text-align:right">2,000,000</td>
                            <td style="text-align:right">20,000,000,000</td>
                            <td>200억</td>
                        </tr>
                        <tr>
                            <td>300만 이상</td>
                            <td style="text-align:right">1</td>
                            <td style="text-align:right">200</td>
                            <td class="table-black"></td>
                            <td class="table-black"></td>
                            <td class="table-black"></td>
                            <td></td>
                        </tr>
                        <tr class="table-total">
                            <td>합계</td>
                            <td></td>
                            <td></td>
                            <td style="text-align:right">12,426,800</td>
                            <td style="text-align:right">124,268,000,000</td>
                            <td></td>
                            <td>1242.68억</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Tier data from spreadsheet
        const hpTiers = [
            { min: 300000, max: 400000, increment: null, rarPerUpgrade: 10, label: "30만 이상 ~ 40만 미만" },
            { min: 400000, max: 500000, increment: null, rarPerUpgrade: 20, label: "40만 이상 ~ 50만 미만" },
            { min: 500000, max: 1000000, increment: 50, rarPerUpgrade: 30, label: "50만 이상 ~ 100만 미만" },
            { min: 1000000, max: 2500000, increment: null, rarPerUpgrade: 50, label: "100만 이상 ~ 250만 미만" },
            { min: 2500000, max: 5550000, increment: null, rarPerUpgrade: 100, label: "250만 이상 ~ 555만 미만" },
            { min: 5550000, max: 5600000, increment: 45, rarPerUpgrade: 200, label: "555만 이상 ~ 560만 미만" },
            { min: 5600000, max: 5650000, increment: 40, rarPerUpgrade: 200, label: "560만 이상 ~ 565만 미만" },
            { min: 5650000, max: 5700000, increment: 35, rarPerUpgrade: 200, label: "565만 이상 ~ 570만 미만" },
            { min: 5700000, max: 5750000, increment: 30, rarPerUpgrade: 200, label: "570만 이상 ~ 575만 미만" },
            { min: 5750000, max: 5800000, increment: 25, rarPerUpgrade: 200, label: "575만 이상 ~ 580만 미만" },
            { min: 5800000, max: 5850000, increment: 20, rarPerUpgrade: 200, label: "580만 이상 ~ 585만 미만" },
            { min: 5850000, max: 5900000, increment: 15, rarPerUpgrade: 200, label: "585만 이상 ~ 590만 미만" },
            { min: 5900000, max: 5950000, increment: 10, rarPerUpgrade: 200, label: "590만 이상 ~ 595만 미만" },
            { min: 5950000, max: 6000000, increment: 5, rarPerUpgrade: 200, label: "595만 이상 ~ 600만 미만" },
            { min: 6000000, max: Infinity, increment: 1, rarPerUpgrade: 200, label: "600만 이상" }
        ];

        const mpTiers = [
            { min: 150000, max: 200000, increment: null, rarPerUpgrade: 10, label: "15만 이상 ~ 20만 미만" },
            { min: 200000, max: 250000, increment: null, rarPerUpgrade: 20, label: "20만 이상 ~ 25만 미만" },
            { min: 250000, max: 500000, increment: null, rarPerUpgrade: 30, label: "25만 이상 ~ 50만 미만" },
            { min: 500000, max: 1000000, increment: 25, rarPerUpgrade: 50, label: "50만 이상 ~ 100만 미만" },
            { min: 1000000, max: 1250000, increment: null, rarPerUpgrade: 50, label: "100만 이상 ~ 125만 미만" },
            { min: 1250000, max: 2750000, increment: null, rarPerUpgrade: 100, label: "125만 이상 ~ 275만 미만" },
            { min: 2750000, max: 2800000, increment: null, rarPerUpgrade: 200, label: "275만 이상 ~ 280만 미만" },
            { min: 2800000, max: 2850000, increment: 20, rarPerUpgrade: 200, label: "280만 이상 ~ 285만 미만" },
            { min: 2850000, max: 2900000, increment: 15, rarPerUpgrade: 200, label: "285만 이상 ~ 290만 미만" },
            { min: 2900000, max: 2950000, increment: 10, rarPerUpgrade: 200, label: "290만 이상 ~ 295만 미만" },
            { min: 2950000, max: 3000000, increment: 5, rarPerUpgrade: 200, label: "295만 이상 ~ 300만 미만" },
            { min: 3000000, max: Infinity, increment: 1, rarPerUpgrade: 200, label: "300만 이상" }
        ];

        function parseNumber(str) {
            return parseInt(str.replace(/,/g, '')) || 0;
        }

        function formatNumber(num) {
            return num.toLocaleString('ko-KR');
        }

        function formatCurrency(num) {
            const billions = num / 100000000;
            if (billions >= 1) {
                return billions.toFixed(2) + '억';
            }
            const tenThousands = num / 10000;
            return formatNumber(Math.round(tenThousands)) + '만';
        }

        function calculateTierRar(current, target, tiers, defaultIncrement) {
            let totalRar = 0;
            let breakdown = [];
            
            // 첫 번째 티어의 min 값보다 작으면 라르 소모 시작점을 첫 번째 티어의 min 값으로 설정
            const firstTierMin = tiers[0].min;
            let currentValue = Math.max(current, firstTierMin);
            
            // 목표값도 첫 번째 티어의 min 값보다 작으면 라르 소모 안 함
            if (target < firstTierMin) {
                return { totalRar, breakdown };
            }

            for (let tier of tiers) {
                if (currentValue >= target) break;
                if (currentValue >= tier.max) continue;
                if (target <= tier.min) continue;

                let tierStart = Math.max(currentValue, tier.min);
                let tierEnd = Math.min(target, tier.max);
                let gainInTier = tierEnd - tierStart;

                if (gainInTier > 0) {
                    let rarNeeded = 0;
                    let upgrades = 0;
                    
                    if (tier.increment) {
                        // increment가 있는 경우: increment 단위로 계산
                        upgrades = Math.ceil(gainInTier / tier.increment);
                        rarNeeded = upgrades * tier.rarPerUpgrade;
                    } else {
                        // increment가 null인 경우: 기본 증가량(defaultIncrement)을 사용하여 비례 계산
                        // 체력: 50씩 증가, 마력: 25씩 증가
                        const tierRange = tier.max - tier.min;
                        const tierTotalRar = (tierRange / defaultIncrement) * tier.rarPerUpgrade;
                        rarNeeded = Math.round((gainInTier / tierRange) * tierTotalRar);
                        upgrades = Math.ceil(gainInTier / defaultIncrement);
                    }
                    
                    totalRar += rarNeeded;

                    breakdown.push({
                        label: tier.label,
                        upgrades: upgrades,
                        rar: rarNeeded,
                        gain: gainInTier
                    });

                    currentValue = tierEnd;
                }
            }

            return { totalRar, breakdown };
        }

        function calculate() {
            // Clear error message
            document.getElementById('errorMessage').classList.add('hidden');

            // Parse inputs
            const currentHP = parseNumber(document.getElementById('currentHP').value);
            const targetHP = parseNumber(document.getElementById('targetHP').value);
            const currentMP = parseNumber(document.getElementById('currentMP').value);
            const targetMP = parseNumber(document.getElementById('targetMP').value);

            // Validation
            let errors = [];
            if (targetHP && currentHP && targetHP <= currentHP) {
                errors.push('목표 HP는 현재 HP보다 커야 합니다.');
            }
            if (targetMP && currentMP && targetMP <= currentMP) {
                errors.push('목표 MP는 현재 MP보다 커야 합니다.');
            }
            if (!targetHP && !targetMP) {
                errors.push('최소한 하나의 목표값을 입력해주세요.');
            }

            if (errors.length > 0) {
                document.getElementById('errorMessage').textContent = errors.join(' ');
                document.getElementById('errorMessage').classList.remove('hidden');
                return;
            }

            // Calculate HP (체력: 50씩 증가)
            let hpResult = { totalRar: 0, breakdown: [] };
            if (targetHP && currentHP && targetHP > currentHP) {
                hpResult = calculateTierRar(currentHP, targetHP, hpTiers, 50);
            }

            // Calculate MP (마력: 25씩 증가)
            let mpResult = { totalRar: 0, breakdown: [] };
            if (targetMP && currentMP && targetMP > currentMP) {
                mpResult = calculateTierRar(currentMP, targetMP, mpTiers, 25);
            }

            // Display results
            displayResults(hpResult, mpResult);
        }

        function formatCash(num) {
            if (num >= 100000000) {
                const billions = num / 100000000;
                return billions.toFixed(2) + '억원';
            } else if (num >= 10000) {
                const tenThousands = num / 10000;
                return tenThousands.toFixed(2) + '만원';
            }
            return formatNumber(Math.round(num)) + '원';
        }

        function displayResults(hpResult, mpResult) {
            // Total Summary
            const totalRar = hpResult.totalRar + mpResult.totalRar;

            // 할인율 계산 (0-99 범위로 제한)
            let discountRate = parseInt(document.getElementById('discountRate').value) || 0;
            discountRate = Math.max(0, Math.min(99, discountRate));
            const rarPricePerUnit = 10000 * (1 - discountRate / 100); // 할인된 라르 가격
            const totalCost = totalRar * rarPricePerUnit; // 골드 비용

            // 어둠돈 환산 계산
            const exchangeRate = parseNumber(document.getElementById('exchangeRate').value) || 6000;
            const totalCostInBillions = totalCost / 100000000; // 골드를 억 단위로 변환
            const totalCash = totalCostInBillions * exchangeRate; // 억 × 환율 = 현금

            document.getElementById('totalRar').textContent = formatNumber(totalRar) + ' 개';
            document.getElementById('totalCost').textContent = formatCurrency(totalCost);
            document.getElementById('totalCash').textContent = formatCash(totalCash);

            // 무료 라르 계산
            const dailyFreeRar = parseNumber(document.getElementById('dailyFreeRar').value) || 0;
            const weeklyFreeRar = parseNumber(document.getElementById('weeklyFreeRar').value) || 0;
            const weeklyRarFromDaily = dailyFreeRar * 7; // 일주일 = 7일
            const totalWeeklyRar = weeklyRarFromDaily + weeklyFreeRar;

            const freeRarSection = document.getElementById('freeRarSection');

            if (totalWeeklyRar > 0 && totalRar > 0) {
                // 주간 획득 라르 표시
                document.getElementById('weeklyRarTotal').textContent = formatNumber(totalWeeklyRar) + ' 개';
                document.getElementById('weeklyRarBreakdown').textContent =
                    `(매일 ${formatNumber(dailyFreeRar)} × 7일 = ${formatNumber(weeklyRarFromDaily)}) + (주간 ${formatNumber(weeklyFreeRar)})`;

                // 필요 주수 계산
                const weeksNeeded = Math.ceil(totalRar / totalWeeklyRar);
                const daysNeeded = weeksNeeded * 7;

                // 기간 표시 (주 + 개월 + 년)
                let periodText = '';
                if (weeksNeeded < 4) {
                    periodText = `${weeksNeeded}주`;
                } else if (weeksNeeded < 52) {
                    const months = Math.floor(weeksNeeded / 4.33);
                    const remainingWeeks = Math.round(weeksNeeded % 4.33);
                    periodText = months + '개월';
                    if (remainingWeeks > 0) {
                        periodText += ` ${remainingWeeks}주`;
                    }
                } else {
                    const years = Math.floor(weeksNeeded / 52);
                    const remainingMonths = Math.floor((weeksNeeded % 52) / 4.33);
                    periodText = years + '년';
                    if (remainingMonths > 0) {
                        periodText += ` ${remainingMonths}개월`;
                    }
                }
                periodText += ` (${formatNumber(weeksNeeded)}주)`;

                document.getElementById('weeksNeeded').textContent = periodText;

                // 예상 달성일 계산
                const targetDateCalc = new Date();
                targetDateCalc.setDate(targetDateCalc.getDate() + daysNeeded);
                const dateOptions = { year: 'numeric', month: 'long', day: 'numeric' };
                document.getElementById('targetDate').textContent = targetDateCalc.toLocaleDateString('ko-KR', dateOptions);

                freeRarSection.classList.remove('hidden');
            } else {
                freeRarSection.classList.add('hidden');
            }

            // 목표 기간 계산
            const targetDays = parseNumber(document.getElementById('targetDays').value) || 0;
            const targetDaysSection = document.getElementById('targetDaysSection');

            if (targetDays > 0 && totalRar > 0) {
                // 목표 기간 내 획득 가능한 무료 라르 계산
                const weeksInPeriod = Math.floor(targetDays / 7);
                const remainingDays = targetDays % 7;
                const freeRarFromDaily = dailyFreeRar * targetDays;
                const freeRarFromWeekly = weeklyFreeRar * weeksInPeriod;
                const totalFreeRarInPeriod = freeRarFromDaily + freeRarFromWeekly;

                // 부족한 라르 계산
                const shortfall = Math.max(0, totalRar - totalFreeRarInPeriod);
                const shortfallCost = shortfall * rarPricePerUnit;
                const shortfallCostInBillions = shortfallCost / 100000000;
                const shortfallCash = shortfallCostInBillions * exchangeRate;

                // 목표 기간 표시
                let targetDaysText = '';
                if (targetDays < 7) {
                    targetDaysText = `${targetDays}일`;
                } else if (targetDays < 30) {
                    const weeks = Math.floor(targetDays / 7);
                    const days = targetDays % 7;
                    targetDaysText = `${weeks}주`;
                    if (days > 0) targetDaysText += ` ${days}일`;
                } else {
                    const months = Math.floor(targetDays / 30);
                    const days = targetDays % 30;
                    targetDaysText = `${months}개월`;
                    if (days > 0) targetDaysText += ` ${days}일`;
                }
                targetDaysText += ` (${formatNumber(targetDays)}일)`;

                document.getElementById('targetDaysDisplay').textContent = targetDaysText;
                document.getElementById('freeRarInPeriod').textContent = formatNumber(totalFreeRarInPeriod) + ' 개';
                document.getElementById('freeRarInPeriodBreakdown').textContent =
                    `(매일 ${formatNumber(dailyFreeRar)} × ${targetDays}일) + (주간 ${formatNumber(weeklyFreeRar)} × ${weeksInPeriod}주)`;

                const shortfallElement = document.getElementById('shortfallRar');
                const messageElement = document.getElementById('targetDaysMessage');

                if (shortfall > 0) {
                    shortfallElement.textContent = formatNumber(shortfall) + ' 개';
                    shortfallElement.className = 'text-3xl font-bold text-red-400 mb-2';
                    document.getElementById('shortfallCost').textContent = formatCurrency(shortfallCost);

                    messageElement.innerHTML = `
                        <p class="text-gray-300 text-sm mb-2">
                            <i class="fas fa-exclamation-triangle mr-2 text-amber-400"></i>
                            목표 기간 내 달성을 위해 <span class="text-red-400 font-bold">${formatNumber(shortfall)}개</span>의 라르를 추가 구매해야 합니다.
                        </p>
                        <p class="text-gray-400 text-xs">
                            추가 비용: ${formatCurrency(shortfallCost)} (약 ${formatCash(shortfallCash)})
                        </p>
                    `;
                } else {
                    shortfallElement.textContent = '0 개';
                    shortfallElement.className = 'text-3xl font-bold text-emerald-400 mb-2';
                    document.getElementById('shortfallCost').textContent = '0원';

                    const surplus = totalFreeRarInPeriod - totalRar;
                    messageElement.innerHTML = `
                        <p class="text-gray-300 text-sm">
                            <i class="fas fa-check-circle mr-2 text-emerald-400"></i>
                            무료 라르만으로 목표 기간 내 달성 가능합니다!
                            <span class="text-emerald-400 font-bold">${formatNumber(surplus)}개</span>의 라르가 남습니다.
                        </p>
                    `;
                }

                targetDaysSection.classList.remove('hidden');
            } else {
                targetDaysSection.classList.add('hidden');
            }

            // Show results section
            document.getElementById('resultsSection').classList.remove('hidden');
            document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        function toggleTable(tableId) {
            const table = document.getElementById(tableId);
            const icon = document.getElementById(tableId + 'Icon');

            if (table.classList.contains('hidden')) {
                table.classList.remove('hidden');
                icon.style.transform = 'rotate(180deg)';
            } else {
                table.classList.add('hidden');
                icon.style.transform = 'rotate(0deg)';
            }
        }

        // 환율 조절 함수 (100원 단위)
        function adjustExchangeRate(amount) {
            const input = document.getElementById('exchangeRate');
            let currentValue = parseNumber(input.value) || 6000;
            currentValue += amount;
            // 최소값 100원으로 제한
            currentValue = Math.max(100, currentValue);
            input.value = formatNumber(currentValue);
        }

        // 할인율 조절 함수 (10% 단위)
        function adjustDiscountRate(amount) {
            const input = document.getElementById('discountRate');
            let currentValue = parseInt(input.value) || 0;
            currentValue += amount;
            // 0~99 범위로 제한
            currentValue = Math.max(0, Math.min(99, currentValue));
            input.value = currentValue;
        }

        // 할인율 입력 검증 (0-99 범위)
        document.getElementById('discountRate').addEventListener('input', function(e) {
            let value = parseInt(e.target.value) || 0;
            if (value < 0) e.target.value = 0;
            if (value > 99) e.target.value = 99;
        });

        // Allow comma input formatting
        document.querySelectorAll('input[type="text"]').forEach(input => {
            input.addEventListener('input', function (e) {
                let value = e.target.value.replace(/,/g, '');
                if (!isNaN(value) && value !== '') {
                    e.target.value = formatNumber(parseInt(value));
                }
            });
        });
    </script>
</body>

</html>